---
title: "PROJECT"
output:
  word_document: default
  html_document: default
  pdf_document: default
date: "2023-10-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


>DATA PREPROCESSING

```{r, results='markup'}
library(dplyr)
library(tidyverse)
library(ggplot2)
```



> Importing Dataset

```{r, results='markup'}
data<- read.csv('Bilateral_Trade_in_Environmental_Goods.csv')
head(data)
```



> Checking Shape of Dataset


```{r, results='markup'}
shape <- dim(data)
cat('Rows:', shape[1], 'Columns:', shape[2], '\n')
```


> Checking data types of columns.

```{r, results='markup'}
data_types <- sapply(data, class)
print(data_types)
```



> Statistical Summary of Dataset

```{r, results='markup'}
summary(data)
```



> Checking null values

```{r, results='markup'}
null_values_count<- colSums(is.na(data))
null_values_dataframe <- data.frame(Column = names(null_values_count), NA_Count = null_values_count)
null_values_dataframe
```


> Removing Some columns from dataset.

```{r, results='markup'}
columns_to_remove <- c('ISO3', 'Counterpart_ISO3', 'Source', 'CTS_Code', 'CTS_Name', 'CTS_Full_Descriptor', 'Unit', 'Scale', 'F1994', 'F1995', 'F1996', 'F1997', 'F1998', 'F1999', 'F2000', 'F2001', 'F2002', 'F2003', 'F2004', 'F2005', 'F2006', 'F2007', 'F2008', 'F2009', 'F2010', 'F2011')

filtered_data <- data[, !(names(data) %in% columns_to_remove)]
head(filtered_data,2)
```

> extracting columns of filtered Data.

```{r, results='markup'}
names(filtered_data)
```


```{r, results='markup'}
unique_country <- table(data$Country)
cat('There are',length(unique_country),'unique countries in dataset')
```

> Checking null values of filtered_data

```{r, results='markup'}
null_values_count<- colSums(is.na(filtered_data))
null_values_dataframe <- data.frame(Column = names(null_values_count), NA_Count = null_values_count)
null_values_dataframe
```

>Droping null values

```{r, results='markup'}
data_cleaned <- na.omit(filtered_data)
```

> Checking shape of cleaned data

```{r, results='markup'}
shape <- dim(data_cleaned)
cat('Rows:', shape[1], 'Columns:', shape[2], '\n')

```
```{r, results='markup'}
head(data_cleaned)
```
> Changing value of object id and resetting index

```{r, results='markup'}
data_cleaned$ObjectId <- seq(1, nrow(data_cleaned))
head(data_cleaned)
```

>save filtered data into csv file

```{r, results='markup'}
write.csv(data_cleaned, "Data.csv", row.names = FALSE)
```





>Filter dataset

```{r, results='markup'}
data<-read.csv("Data.csv")
head(data)
```


> No. of unique countries after filtering dataset

```{r, results='markup'}
unique_country <- table(data$Country)
cat('There are',length(unique_country),'unique countries in dataset')
```



>Exploratory Data Analysis

```{r, results='markup'}

```

--- SMART QUESTION 01: What is the trend in global environmental goods exports over the last decade (2013-2022)?



```{r, results='markup'}
exports_data <- filter(data, Indicator == "Environmental goods exports") 
head(exports_data)
```

```{r, results='markup'}
exports_trend <- colSums(exports_data[, c("F2013", "F2014", "F2015", "F2016", "F2017", "F2018", "F2019", "F2020", "F2021", "F2022")], na.rm = TRUE)
exports_trend 
```
```{r, results='markup'}
exports_trend <- round(exports_trend / 1000000000) #Converting the tota cost of exports into billion

```


```{r, results='markup'}
exports_trend_df <- data.frame(Year = 2013:2022, 'Exports_In_Billions' = exports_trend)
head(exports_trend_df)

```


```{r, results='markup'}

ggplot(exports_trend_df, aes(x = Year, y = Exports_In_Billions)) +
  geom_line(group = 1, color = '#38599F') +
  geom_point(color="#00297b") +
  labs(title = "Global Environmental Goods Exports (2013-2022)",
       x = "Year",
       y = "Total Exports (US Dollars in billions)") +
  
  scale_x_continuous(breaks = 2013:2022) +
  scale_y_continuous(breaks = seq(300, 500, by = 25))
  

```
>Linear Regression Model

```{r}

env_goods_exports <- subset(data, Indicator == 'Environmental goods exports')
head(env_goods_exports)

```

```{r}
years <- paste0('F', 2013:2022)
env_goods_exports_years <- env_goods_exports[, c('Country', years)]
head(env_goods_exports_years)
```

```{r}
total_exports_by_year <- colSums(env_goods_exports_years[, -1], na.rm = TRUE)
head(total_exports_by_year, 3)
```
```{r}
total_exports_df <- data.frame(Year = as.numeric(sub("F", "", names(total_exports_by_year))), 
                                Total_Export_Value = total_exports_by_year)
total_exports_df <- arrange(total_exports_df, Year)
total_exports_df$Total_Export_Value <- (total_exports_df$Total_Export_Value/1000000000)
head(total_exports_df)
```


```{r}

variance_exports <- var(total_exports_df$Total_Export_Value)
sd_exports <- sd(total_exports_df$Total_Export_Value)
```

```{r}
variance_exports <- var(total_exports_df$Total_Export_Value)
sd_exports <- sd(total_exports_df$Total_Export_Value)

cat('Variance: ',variance_exports, 'Standard deviation: ',sd_exports)
```

```{r}
print(total_exports_df)
cat('Variance of Exports:', variance_exports, '\n')
cat('Standard Deviation of Exports:', sd_exports, '\n')
```

```{r}
linear_model <- lm(Total_Export_Value ~ Year, data = total_exports_df)
model_summary <- summary(linear_model)

```

```{r}
head(total_exports_df)
```

```{r}
total_exports_df$residuals <- residuals(linear_model)
total_exports_df$predicted <- fitted(linear_model)

plot <- ggplot(total_exports_df, aes(x = Year)) +
  geom_point(aes(y = Total_Export_Value, color = "Actual Data Points"), size = 3) +
  geom_line(aes(y = predicted, linetype = "Trend Line"), size = 0.77, color = "#38599f") +
  geom_point(aes(y = predicted, color = "Predicted Points"), size = 4, shape = 17) +
  scale_color_manual(values = c("Actual Data Points" = "#00297b", 
                                "Predicted Points" = "#a5bfd1")) +
  scale_linetype_manual(values = c("Trend Line" = "solid")) +
  labs(title = "Trend in Global Environmental Goods Exports (2013-2022)",
       x = "Year",
       y = "Total Export Value (in billions)",
       color = "Legend",
       linetype = "Legend") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(min(total_exports_df$Year), max(total_exports_df$Year), by = 1)) +
  guides(color = guide_legend(override.aes = list(shape = c(16, 17), size = c(3, 4))),
         linetype = guide_legend(override.aes = list(size = 0.77)))+scale_y_continuous(breaks = seq(300, 500, by = 25))


print(plot)



```

-----------------SMART QUESTION 2----------------------------

```{r}


selected_data <- exports_data %>%
  select(Country, F2018, F2019, F2020, F2021, F2022)
head(exports_data)

```

```{r, results='markup'}
head(selected_data)
```


```{r}
# Step 3: Check for each country if the exports have increased every year
increasing_exports <- selected_data %>%
  filter(F2018 < F2019 & F2019 < F2020 & F2020 < F2021 & F2021 < F2022) %>%
  arrange(desc(F2022))
```


```{r}
head(increasing_exports)
```

```{r}

increasing_exports_long <- increasing_exports %>%
  gather(key = "Year", value = "Exports", -Country) %>%
  mutate(Year = as.numeric(sub("F", "", Year))) 

increasing_exports_long$Exports=round(increasing_exports_long$Exports/1000000000)

top_three_countries <- head(increasing_exports, 3)


top_three_countries_names <- top_three_countries$Country

top_three_countries_long <- increasing_exports_long %>%
  filter(Country %in% top_three_countries_names)

top_three_countries_long <- top_three_countries_long %>%
  mutate(Country_Year = paste(Country, Year, sep = "-"))
head(top_three_countries_long)

```




```{r}
ggplot(top_three_countries_long, aes(x = Country, y = Exports, fill = as.factor(Year))) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7) +
  scale_fill_manual(values = c("2018" = "#00297b", "2019" = "#38599F", "2020" = "#698bbD", "2021" = "#A5bfd1", "2022" = "#f1f1d2")) +
  labs(title = "Environmental Goods Exports Trend (2018-2022)",
       x = "Country",
       y = "Exports (US Dollars in billions)",
       fill = "Year") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0,15,by=1))
  theme(legend.position = "bottom")
```

>>> SMART QUESTION 04: How do landlocked countries compare to coastal countries in terms of environmental goods imports in 2022?

```{r}
# Define the groups of countries
landlocked_countries_group <- c('Czech Republic', 'Hungary', 'Azerbaijan', 'Bolivia', 'Georgia')
coastal_countries_group <- c('Chile', 'Greece', 'Jordan', 'Estonia', 'Mozambique')

# Filter data for the specified countries, indicators, and the year 2022
filtered_group_data <- data %>%
  filter(Country %in% c(landlocked_countries_group, coastal_countries_group),
         Indicator %in% c('Environmental goods imports', 'Environmental goods exports'),
         Trade_Flow %in% c('Imports', 'Exports')) %>%
  select(Country, Indicator, Trade_Flow, F2022)

# Display the filtered data
head(filtered_group_data)
```
```{r}
# Add a new column for country classification
filtered_group_data$Country_Classification <- ifelse(filtered_group_data$Country %in% landlocked_countries_group, 'Landlocked', 'Coastal')
head(filtered_group_data)
```
```{r}
# Calculate total trade (imports and exports) for landlocked and coastal groups
total_trade_group <- filtered_group_data %>%
  group_by(Country_Classification, Trade_Flow) %>%
  summarise(Total_Trade = sum(F2022)) %>%
  spread(key = Trade_Flow, value = Total_Trade)
head(total_trade_group)
```


```{r}


# Transform the data to a long format
total_trade_long <- total_trade_group %>%
  gather(key = "Trade_Flow", value = "Amount", -Country_Classification)
head(total_trade_long)
```


```{r}
p <- ggplot(total_trade_long, aes(x = Country_Classification, y = Amount, fill = Trade_Flow)) +
  geom_col(position = "dodge", width = 0.6) +
  scale_y_continuous(
    labels = scales::label_number(scale = 1e-9, accuracy = 1),
    limits = c(0, 3e10),
    breaks = seq(0, 3e10, by = 5e9)
  ) +
  labs(
    y = "Amount in Billions",
    x = "Country Classification",
    title = "Environmental Goods Imports and Exports in 2022",
    subtitle = "Landlocked vs Coastal Countries"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Exports" = "#38599F", "Imports" = "#698bbd")) +
  geom_text(aes(label = scales::label_number(accuracy = 0.01)(Amount/1e9)),
            position = position_dodge(width = 0.6), vjust = -0.5)

# Show the plot
p
```


--------------------SMART QUESTION 05-------------------
```{r}
india_trade <- filter(data, Counterpart_Country == 'India')
```

```{r}
environmental_trade <- filter(india_trade, Indicator %in% c('Environmental goods exports', 'Environmental goods imports'))
```

```{r}
country_indicator_count <- environmental_trade %>%
  group_by(Country) %>%
  summarise(Unique_Indicators = n_distinct(Indicator))
```

```{r}
countries_with_both <- filter(country_indicator_count, Unique_Indicators == 2) %>%
  pull(Country)
```

```{r}
filtered_data <- filter(environmental_trade, Country %in% countries_with_both)

# Step 2: Group the data by country and indicator, and calculate the sum for each group
grouped_data <- filtered_data %>%
  group_by(Country, Indicator) %>%
  summarise(Sum = sum(F2022, na.rm = TRUE)) %>%
  ungroup()

# Step 3: Pivot the data to have exports and imports in separate columns for easier comparison
trade_sums <- grouped_data %>%
  spread(key = Indicator, value = Sum)

# Step 4: Replace NaN values with 0
trade_sums[is.na(trade_sums)] <- 0
trade_sums
```
```{r}
#Step 1: Calculate the Import-Export Difference
trade_sums <- trade_sums %>%
  mutate(Import_Export_Difference = `Environmental goods imports` - `Environmental goods exports`)

# Step 2: Select Specific Columns
result <- select(trade_sums, Country, Import_Export_Difference)
head(result)
```

```{r}
trade_values <- trade_sums %>%
  pivot_longer(cols = c(`Environmental goods exports`, `Environmental goods imports`),
               names_to = "Indicator",
               values_to = "Trade_Value")

# Showing the trade values
print(trade_values)
```

```{r}
# Step 1: Calculate the Import-Export Difference
trade_sums <- trade_sums %>%
  mutate(Import_Export_Difference = `Environmental goods imports` - `Environmental goods exports`)

# Step 2: Select Specific Columns
result <- select(trade_sums, Country, Import_Export_Difference)
head(result)
```

```{r}
library(ggplot2)

top_countries <- result %>%
  arrange(desc(abs(Import_Export_Difference)))

# Step 2: Select the Top 10
top_10_countries <- head(top_countries, 10)

# Step 3: Create the Plot
ggplot(data = top_10_countries, aes(x = reorder(Country, -abs(Import_Export_Difference)), y = Import_Export_Difference)) +
  geom_bar(stat = "identity", fill = "#698bbd") +
  labs(title = "Top 10 Countries: Import-Export Difference of Environmental Goods",
       x = "Country",
       y = "Import-Export Difference") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```










--- SMART QUESTION 06

```{r}
trade_balance_data <- filter(data, data$Indicator == 'Environmental goods trade balance')
head(trade_balance_data)
```


```{r}
asian_countries = c('Afghanistan', 'Armenia', 'Azerbaijan', 'Bahrain', 'Bangladesh', 'Bhutan', 'Brunei Darussalam', 'Cambodia', 'China', 'Cyprus', 'Georgia', 'India', 'Indonesia', 'Iran (Islamic Republic of)', 'Iraq', 'Israel', 'Japan', 'Jordan', 'Kazakhstan', 'Kuwait', 'Kyrgyzstan', 'Lao People\'s Democratic Republic', 'Lebanon', 'Malaysia', 'Maldives', 'Mongolia', 'Myanmar', 'Nepal', 'Korea (Democratic People\'s Republic of)', 'Oman', 'Pakistan', 'Palestine', 'Philippines', 'Qatar', 'Saudi Arabia', 'Singapore', 'Korea (Republic of)', 'Sri Lanka', 'Syrian Arab Republic', 'Taiwan', 'Tajikistan', 'Thailand', 'Timor-Leste', 'Turkey', 'Turkmenistan', 'United Arab Emirates', 'Uzbekistan', 'Viet Nam', 'Yemen')

european_countries = c('Albania', 'Andorra', 'Austria', 'Belarus', 'Belgium', 'Bosnia and Herzegovina', 'Bulgaria', 'Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Estonia', 'Finland', 'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Latvia', 'Liechtenstein', 'Lithuania', 'Luxembourg', 'Malta', 'Moldova', 'Monaco', 'Montenegro', 'Netherlands', 'North Macedonia', 'Norway', 'Poland', 'Portugal', 'Romania', 'Russian Federation', 'San Marino', 'Serbia', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Ukraine', 'United Kingdom', 'Vatican City State (Holy See)')
```


```{r}
trade_balance_data$Region <- ifelse(trade_balance_data$Country %in% asian_countries, 'Asia',
                                    ifelse(trade_balance_data$Country %in% european_countries, 'Europe', 'Other'))
head(trade_balance_data)
```
```{r}
# Select the columns for years and Region
years <- c('F2015', 'F2016', 'F2017', 'F2018', 'F2019', 'F2020', 'F2021', 'F2022')
agg_data <- trade_balance_data %>%
  select(one_of(c("Region", years)))
# Group by 'Region' and calculate the sum for each year
agg_data <- agg_data %>%
  group_by(Region) %>%
  summarise(across(.cols = everything(), .fns = sum, na.rm = TRUE))
# Filter only 'Asia' and 'Europe'
agg_data <- agg_data %>%
  filter(Region %in% c('Asia', 'Europe'))
head(agg_data)
```

```{r, results='markup'}
result6 <- data.frame(Year = 2015:2022, 
                      'Asia' = t(agg_data[1,2:ncol(agg_data)]), 
                      'Europe' = t(agg_data[2,2:ncol(agg_data)]))
head(result6)

```

```{r}
ggplot(result6, aes(x = Year)) +
  geom_line(aes(y = Asia / 1000000000, label='Asia'), color = "red", linetype = "solid") +
  geom_line(aes(y = Europe / 1000000000, label='Europe'), color = "blue", linetype = "solid") +
  labs(
    title = "Total Trade Balance by Year (in Billions)",
    x = "Year",
    y = "Trade Balance"
  ) +
  scale_color_manual(values = c("Asia" = "red", "Europe" = "blue"),
                     name = "Legend",
                     labels = c('Asia', 'Europe')) +
  theme_minimal()
```

```{r}
correlation_coefficient <- cor(result6['Asia'], result6['Europe'])
cat("Pearson Correlation Coefficient:", correlation_coefficient, "\n")
```


--- SMART QUESTION 07

```{r}
us_data = filter(trade_balance_data, Counterpart_Country == "United States")
us_data <- us_data %>% 
  select("Country", "F2012", "F2013", "F2014", "F2015", "F2016", "F2017", "F2018", "F2019", "F2020", "F2021", "F2022")
head(us_data)
```

```{r}
# Convert the data into a long format
trade_balance_data_long <- pivot_longer(us_data, 
                                       cols = starts_with("F"), 
                                       names_to = "Year", 
                                       values_to = "Balance")
trade_balance_data_long$Year <- as.numeric(substring(trade_balance_data_long$Year, 2))
head(trade_balance_data_long)
```

```{r}
# Create the multiline graph
ggplot(trade_balance_data_long, aes(x = Year, y = Balance / 1000000000, color = Country)) +
  geom_line() + 
  geom_point() +
  labs(
    title = "Trade Balance with the USA",
    x = "Year",
    y = "Balance in Billions"
  ) +
  theme_minimal() +
  theme(legend.position = "top") +
  scale_x_continuous(breaks = seq(min(as.numeric(trade_balance_data_long$Year)), 
                                  max(as.numeric(trade_balance_data_long$Year)), 1))
```

```{r}
fluctuation_data <- us_data %>%
  mutate(Fluctuation = F2022 - F2012)

ggplot(fluctuation_data, aes(x = Country, y = Fluctuation / 1000000000)) +
  geom_bar(stat = "identity", fill = "#698bbd") +
  labs(
    title = "Environmental Goods Trade Balance Fluctuation (2010-2022)",
    x = "Country",
    y = "Fluctuation in Billions"
  ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

```{r}
max_fluctuation_index <- which.max(abs(fluctuation_data$Fluctuation))
country_with_max_fluctuation <- fluctuation_data$Country[max_fluctuation_index]
max_fluctuation <- fluctuation_data$Fluctuation[max_fluctuation_index]

cat("Country with Maximum Fluctuation (based on absolute values):", country_with_max_fluctuation, "\n")
cat("Maximum Fluctuation Value (based on absolute values in billions):", max_fluctuation / 1000000000, "\n")
```


------------------SMART QUESTION 08----------------------------

```{r}
#filtered_data = data[['Country', 'Counterpart_Country', 'Trade_Flow', 'F2022']]
filtered_data <- data %>%
  select(Country, Counterpart_Country, Trade_Flow, F2022)
head(filtered_data)
```

```{r}
#calculate mutual trade volume.
filtered_data_2 <- filtered_data %>%
  mutate(Country_Pair = if_else(Country < Counterpart_Country,
                                paste(Country, Counterpart_Country, sep = " - "),
                                paste(Counterpart_Country, Country, sep = " - ")))
head(filtered_data_2)
```

```{r}
# Calculate the mutual trade volume for each country pair
mutual_trade_volume <- filtered_data_2 %>%
  group_by(Country_Pair) %>%
  summarise(Total_Trade_2022 = sum(F2022, na.rm = TRUE)) %>%
  ungroup()
head(mutual_trade_volume)
```

```{r}
#sort the results and find the country pairs with the highest mutual trade volume in 2022
highest_mutual_trade_volume <- mutual_trade_volume %>%
  arrange(desc(Total_Trade_2022))
highest_mutual_trade_volume<- head(highest_mutual_trade_volume,15)
highest_mutual_trade_volume$Total_Trade_2022<- highest_mutual_trade_volume$Total_Trade_2022/10000000000
head(highest_mutual_trade_volume)
```

```{r}
ggplot(highest_mutual_trade_volume, aes(x = reorder(Country_Pair, -Total_Trade_2022), y = Total_Trade_2022)) +
  geom_segment(aes(x = reorder(Country_Pair, -Total_Trade_2022), xend = reorder(Country_Pair, -Total_Trade_2022), y = 0, yend = Total_Trade_2022), color = "#00297b", size = 1) +
  geom_point(aes(x = reorder(Country_Pair, -Total_Trade_2022), y = Total_Trade_2022), color = "#698bbd", size = 4) +
  geom_point(aes(x = reorder(Country_Pair, -Total_Trade_2022), y = Total_Trade_2022), color = "black", size = 4, shape = 1) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
  labs(title = "Mutual Trade Volume in 2022",
       x = "Country Pair",
       y = "Trade Volume (USD)")

```

>Statistical Testing

>Hypothesis:
Is there a significant difference in mutual trade volumes across different country-counterpart pairs in 2022?"

>Test: ANNOVA 
# Step 1: Prepare the data for ANOVA

```{r}

dataset <- data %>%
  group_by(Country, Counterpart_Country) %>%
  mutate(Mutual_Trade_2022 = sum(F2022, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
unique_pairs <- dataset %>%
  distinct(Country, Counterpart_Country, .keep_all = TRUE)
sorted_pairs <- unique_pairs %>%
  arrange(desc(Mutual_Trade_2022))
top_pairs <- head(sorted_pairs, 15)
head(top_pairs)
```

```{r}
anova_data <- lapply(1:nrow(top_pairs), function(i) {
  row <- top_pairs[i, ]
  subset_data <- subset(dataset, Country == row$Country & Counterpart_Country == row$Counterpart_Country)
  c(subset_data$F2012, subset_data$F2013, subset_data$F2014, subset_data$F2015, subset_data$F2016,
    subset_data$F2017, subset_data$F2018, subset_data$F2019, subset_data$F2020, subset_data$F2021, subset_data$F2022)
})
```

```{r}
anova_df <- data.frame(
  values = unlist(anova_data),
  group = factor(rep(1:10, each = 11))
)
head(anova_df)
```

```{r}
# Performing the ANOVA test
anova_result <- aov(values ~ group, data = anova_df)
summary(anova_result)
```

>Conclusion:
Because the p-value (0.78) is much greater than the common alpha level of 0.05, we fail to reject the null hypothesis.
There is not enough statistical evidence to conclude that there is a significant difference in mutual trade volumes across different country-counterpart pairs in 2022.
Interpretation:
The mutual trade volumes across the selected country-counterpart pairs in 2022 do not significantly differ from each other, based on the ANOVA test conducted on the top trading pairs. This suggests that the variations in trade volumes within the pairs are not significantly less than the variations between the pairs.


-------------------------------SMART QUESTION 9------------------------------------------------------

```{r}


#filtered_data = data[['Country', 'Counterpart_Country', 'Trade_Flow', 'F2022']]
filtered_data <- data %>%
  select(Country, Counterpart_Country, Trade_Flow, F2022)
head(filtered_data)
trade_partnerships <- filtered_data %>%
  group_by(Country) %>%
  summarise(Unique_Trade_Partners = n_distinct(Counterpart_Country)) %>%
  ungroup()
head(trade_partnerships)
```

```{r}
#Find the Country with the Most Diversified Trade

most_diversified_trade = most_diversified_trade <- trade_partnerships %>%
  arrange(desc(Unique_Trade_Partners))
head(most_diversified_trade)
```

```{r}
# Bar Chart


# Bar Chart
ggplot(most_diversified_trade, aes(x = reorder(Country, -Unique_Trade_Partners), y = Unique_Trade_Partners)) +
  geom_bar(stat = "identity", fill = "#00297b") +
  theme_minimal() +
  labs(title = "Number of Unique Trade Partnerships in 2022",
       x = "Country",
       y = "Number of Unique Trade Partners") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

```
> Statistical Testing

> Herfindahl-Hirschman Index (HHI):




```{r}
head(most_diversified_trade)
```


```{r}
total_trade <- data %>%
  group_by(Country) %>%
  summarise(Total_Trade_2022 = sum(F2022, na.rm = TRUE))
head(total_trade)
```
```{r}
trade_proportions <- data %>%
  left_join(total_trade, by = "Country") %>%
  mutate(Trade_Proportion = F2022 / Total_Trade_2022)
head(trade_proportions)
```



```{r}
# Assuming trade_proportions is your data frame and is already available in your R environment
hhi_results <- trade_proportions %>%
  group_by(Country) %>%
  summarise(HHI = round(sum(Trade_Proportion^2), 2))

# Now hhi_results will contain the HHI values rounded to two decimal places
print(hhi_results)
```

```{r}
hhi_data <- hhi_results %>%
  mutate(Group = case_when(
    hhi_results$HHI >= 0.25 ~ "Low Diversity",
    hhi_results$HHI >= 0.15 & hhi_results$HHI < 0.25 ~ "Moderate Diversity",
    hhi_results$HHI < 0.15 ~ "High Diversity"
  ))
head(hhi_data)
```

```{r}
hhi_data$Group <- as.factor(hhi_data$Group)
head(hhi_data)
```
```{r}
anova_result <- aov(HHI ~ Group, data = hhi_data)
summary(anova_result)
```


>Null Hypothesis (H0): All countries have the same level of diversity in their environmental goods trade partnerships in 2022.

>Alternative Hypothesis (H1): There is at least one country that has a significantly different level of diversity in its environmental goods trade partnerships in 2022 compared to other countries.



>Conclusion:  This means that there is a statistically significant difference in the diversity of environmental goods trade partnerships among the countries in 2022.



































































